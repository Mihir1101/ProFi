// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.18;

import "@openzeppelin/contracts/access/Ownable.sol";

contract BNB is Ownable {
    // =========================================================
    //                      Safe Math
    // =========================================================

    function SafeSub(uint256 a, uint256 b) public pure returns (uint256) {
        if (a < b) {
            return (b - a);
        } else {
            return (a - b);
        }
    }

    // ========================================================
    //        Storage Variables, events and constructors
    // ========================================================

    uint256[] private open;
    uint256[] private close;
    uint256[] private high;
    uint256[] private low;
    uint256[] private volume;
    uint256[] private marketCap;
    uint256 private markets;
    uint256 private github_commits;
    uint256[] private algo_array;

    constructor(address initialOwner) Ownable(initialOwner) {
        open = [
            1045949981,
            22016899586,
            12841800451,
            13351600170,
            19969500303,
            86295299530,
            111782999039,
            104482002258,
            111519002914,
            143145999908,
            142517004013,
            146761999130,
            137696000000,
            110266000000,
            100097000000,
            93713100000,
            50866951291,
            61914315950,
            62641423472,
            103569312874,
            174106383476,
            221347514224,
            327476399387,
            324424831405,
            276221987322,
            212587281589,
            158827512463,
            199941137989,
            157431813567,
            137309616834,
            182028033441,
            195746153558,
            125816060263,
            170465216634,
            170695305596,
            154094564636,
            206681463971,
            231850478859,
            293217805300,
            284312146800,
            314115090700,
            373745723400,
            443090748700,
            2099513023100,
            3022454825800,
            6224693109900,
            3537825338500,
            3035273648100,
            3322926820600,
            4642729309600,
            3876359992371,
            5247382458046,
            6218128471058,
            5119103559006,
            3750991676374,
            3956241248129,
            4291240316226,
            3777656539101,
            3204720304916,
            2195289969503,
            2836294951458,
            2792513297895,
            2842734081441,
            3262778726408,
            3007543693272,
            2463329064814,
            3122771322146,
            3015103383920,
            3170597912610,
            3376052360161,
            3068828148235,
            2403869056243,
            2411280474149,
            2165984771091
        ];
        close = [
            961093977,
            5267549753,
            10960500240,
            11956199407,
            19229700565,
            79592199326,
            55900697707,
            71742300987,
            103782997131,
            117031002045,
            135444002151,
            116484003067,
            86626600000,
            90373100000,
            92365100000,
            44422300000,
            41899707140,
            54934209686,
            61722954174,
            103256339365,
            165892174312,
            184670879759,
            291836236921,
            249036450216,
            211903079524,
            148412790204,
            151910243232,
            141953532586,
            121837306928,
            129899737922,
            178241573690,
            69633908610,
            120578428848,
            142843799319,
            150206507686,
            152450292044,
            199726868368,
            181837083019,
            258940291800,
            258971505500,
            267652262400,
            351708843500,
            435241928800,
            2099513023100,
            3015886682400,
            2135164667100,
            2262978428500,
            2558507594000,
            3180628229100,
            3203687514607,
            3821313861951,
            5121762465460,
            4951322719729,
            3378539417632,
            3244836853227,
            3603018549910,
            3777678267306,
            2163615019615,
            1845400570331,
            2136656295493,
            2728059676159,
            2571868283463,
            2579745108446,
            2506569389838,
            2210031953179,
            2416924913861,
            2836963834532,
            2657124436159,
            3005087643474,
            3015824098111,
            2220713416072,
            2316457438946,
            2043991384887,
            2043567342525
        ];
        high = [
            29554500580,
            28492701054,
            20329499245,
            21742300987,
            113022003174,
            249120998383,
            118706998825,
            148387002945,
            159259004593,
            162205009460,
            174381008148,
            148694000244,
            144551000000,
            115422999999,
            107457000000,
            98838800000,
            65852006900,
            72467699391,
            113237735009,
            175683406535,
            255334085745,
            355045000474,
            395665352017,
            343131249385,
            313016108224,
            235352134712,
            209177849952,
            216357134592,
            160777697284,
            188409605733,
            271174555640,
            217016712408,
            181295282933,
            181084840338,
            181563462018,
            208384760047,
            239141650122,
            334878209890,
            323450693599,
            352823083600,
            394842332100,
            470981027300,
            3428795927900,
            3164865299100,
            6374423326400,
            6909319646800,
            4323081030500,
            3391676770400,
            5187563285000,
            5100576498900,
            5399388314079,
            6693458077752,
            6502531833893,
            5333710045832,
            4442885960113,
            4519610860247,
            4598055830280,
            4124003743177,
            3238850595571,
            3012096954643,
            3362836925669,
            2991763042920,
            3367953167816,
            3887155250829,
            3014796862717,
            3227462254780,
            3373205290011,
            3464451172025,
            3500722982745,
            3393916697564,
            3083961409048,
            2611026000435,
            2485115564717,
            2210098501587
        ];
        low = [
            961093977,
            5267549753,
            10960500240,
            11956199407,
            19229700565,
            79592199326,
            55900697707,
            71742300987,
            103782997131,
            117031002045,
            135444002151,
            116484003067,
            86626600000,
            90373100000,
            92365100000,
            44422300000,
            41899707140,
            54934209686,
            61722954174,
            103256339365,
            165892174312,
            184670879759,
            291836236921,
            249036450216,
            211903079524,
            148412790204,
            151910243232,
            141953532586,
            121837306928,
            129899737922,
            178241573690,
            69633908610,
            120578428848,
            142843799319,
            150206507686,
            152450292044,
            199726868368,
            181837083019,
            258940291800,
            258971505500,
            267652262400,
            351708843500,
            435241928800,
            2099513023100,
            3015886682400,
            2135164667100,
            2262978428500,
            2558507594000,
            3180628229100,
            3203687514607,
            3821313861951,
            5121762465460,
            4951322719729,
            3378539417632,
            3244836853227,
            3603018549910,
            3777678267306,
            2163615019615,
            1845400570331,
            2136656295493,
            2728059676159,
            2571868283463,
            2579745108446,
            2506569389838,
            2210031953179,
            2416924913861,
            2836963834532,
            2657124436159,
            3005087643474,
            3015824098111,
            2220713416072,
            2316457438946,
            2043991384887,
            2043567342525
        ];
        volume = [
            202148000000000000,
            61945700000000000,
            33971500000000000,
            315595000000000000,
            749279040000000000,
            504350000000000000,
            690364000000000000,
            892563040000000000,
            837658000000000000,
            939316960000000000,
            596769000000000000,
            665370000000000000,
            226382000000000000,
            269540000000000000,
            213982000000000000,
            106990243400000000,
            382160144900000000,
            522404505700000000,
            1006269632800000000,
            1999902827100000000,
            1903261794600000000,
            5039897339700000768,
            2866322520400000000,
            2029505755300000000,
            1675891663500000000,
            1243290601500000000,
            2502258403200000000,
            2134281309400000000,
            1662782539300000000,
            2450359220900000256,
            5842193660000000000,
            3725660804000000000,
            4980159441800000512,
            3066134680600000000,
            1515824610100000000,
            2297810799400000000,
            2155111999700000000,
            5665601443600000000,
            3605969976700000256,
            3896084807200000512,
            4041408956899999744,
            5125454433900000256,
            31296990025699999744,
            35454934157600002048,
            57413580483299999744,
            38656918453100003328,
            19035384478699999232,
            17179840148199999488,
            23780493279499997184,
            17962356458499999744,
            20762899147399999488,
            27815316937699999744,
            20204898982300000256,
            13867781837300000768,
            18683493802199998464,
            26325342842099998720,
            14676057702899998720,
            17115329600899999744,
            10888520647900000256,
            13135315230599999488,
            9524868771599998976,
            9054815718800000000,
            21684057594600001536,
            10096203357200001024,
            3075518531400000000,
            4874721842599999488,
            3376732650000000000,
            4194300094700000256,
            8652289558499999744,
            144969293950000005120,
            167279919326499995648,
            158553922124100009984,
            140064706329699991552,
            114331504794999996416
        ];
        marketCap = [
            2203790000000000000,
            1283580000000000000,
            1299944904600000000,
            1977279875800000256,
            8550433181200000000,
            11035110300000000000,
            10335279348000000000,
            10946888825999998976,
            16321703481800001536,
            16182687149100001280,
            16715374015200000000,
            13157232108399998976,
            10519558270200000512,
            11765235007599998976,
            12249303530100000768,
            6642737991500000256,
            8063426642200000512,
            8097282642700000256,
            14633090432600000512,
            24566893090199998464,
            31239080339399999488,
            46232383531099996160,
            45800834620400001024,
            42997434582700007424,
            33076303915200000000,
            24672282543900000256,
            31107705191100002304,
            24444073904800002048,
            21351523711400001536,
            28324760374099996672,
            30460451998499999744,
            19569016455900000256,
            26494085782199996416,
            26504189856000000000,
            23973779120500002816,
            29846159227800002560,
            33492286541199998976,
            42297947641799999488,
            41056539354299998208,
            45333242404300005376,
            53973444077099999232,
            68420923728699998208,
            323861163314799968256,
            466787076313000050688,
            957544884022899900416,
            543657778694700007424,
            465355650430800035840,
            560820377204800028672,
            780859888827299921920,
            650786755995999928320,
            874645918834600050688,
            1038620477144799903744,
            853535362220200034304,
            619645765898200023040,
            653222405569199996928,
            708212366498800074752,
            616807878611299991552,
            523278389875999965184,
            358066565717200011264,
            457519354525400039424,
            450515091288799969280,
            458508074788500013056,
            522106451892499972096,
            481182834303600033792,
            394071735157099986944,
            493222987010999975936,
            476014444332300042240,
            500569642457799983104,
            526263459363799957504,
            478271810934100066304,
            374619380687199993856,
            370976834282600005632,
            333236554352700030976,
            330495352197900009472
        ];
        markets = 6740000000000;
        github_commits = 151210000000000;
        algo_array = new uint256[](0);
    }

    // ========================================================
    //         Functions to add data into the array
    // ========================================================

    function addOpen(uint256 item) public onlyOwner {
        open.push(item);
    }

    function addClose(uint256 item) public onlyOwner {
        close.push(item);
    }

    function addHigh(uint256 item) public onlyOwner {
        high.push(item);
    }

    function addLow(uint256 item) public onlyOwner {
        low.push(item);
    }

    function addVolume(uint256 item) public onlyOwner {
        volume.push(item);
    }

    function addMarketCap(uint256 item) public onlyOwner {
        marketCap.push(item);
    }

    function update_markets(uint256 item) public onlyOwner {
        markets = item;
    }

    function update_github_commits(uint256 item) public onlyOwner {
        github_commits = item;
    }

    // ========================================================
    //            Functions to get the data arrays
    // ========================================================

    function getParams()
        public
        view
        returns (
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256,
            uint256,
            uint256[] memory
        )
    {
        return (
            open,
            close,
            high,
            low,
            volume,
            marketCap,
            markets,
            github_commits,
            algo_array
        );
    }

    // ============================================================
    //           Functions used in the algorithm
    // ============================================================

    function normalize_between_zero_and_1e10(
        uint256 value
    ) public pure returns (uint256) {
        unchecked {
            while (value >= 1e10) {
                value /= 10;
            }
            while (value < 0) {
                value *= 10;
            }
        }
        return uint256(value);
    }

    function check_size(
        uint256 value1,
        uint256 value2
    ) public pure returns (uint256) {
        unchecked {
            if (value1 > value2) {
                return uint256(1);
            } else {
                return uint256(0);
            }
        }
    }

    function abs(int256 n) internal pure returns (uint256) {
        unchecked {
            return uint256(n >= 0 ? n : -n);
        }
    }

    function generate_algo_array() public {
        for (uint256 i = 0; i < (open.length - 1); i++) {
            uint256 first;
            if (high[0] > low[0]) {
                first = high[0] - low[0];
            } else {
                first = low[0] - high[0];
            }
            uint256 second;
            if (close[0] > open[0]) {
                second = close[0] - open[0];
            } else {
                second = open[0] - close[0];
            }
            uint256 result;
            if (second == 0) {
                result = 1e10;
            } else {
                result = ((first * 1e10) / (second));
            }
            uint256 algo = (2 * normalize_between_zero_and_1e10(result)) +
                (2 *
                    (1e10 - (SafeSub(marketCap[i], marketCap[i + 1]) / 1e11))) +
                (2 * (1e10 - (SafeSub(volume[i], volume[i + 1]) / 1e11))) +
                (1 * ((markets) / 1e4)) +
                (2 * ((github_commits) / 1e5)) +
                (1e10 * check_size(close[i], open[i]));

            algo_array.push(algo);
        }
    }

    function return_safeness_score() public view returns (uint256) {
        uint256 score_sum = 0;
        for (uint256 i = 0; i < algo_array.length; i++) {
            score_sum = score_sum + algo_array[i];
        }
        return ((score_sum) / algo_array.length);
    }
}
