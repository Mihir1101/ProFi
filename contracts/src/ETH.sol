// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.18;

import "@openzeppelin/contracts/access/Ownable.sol";

contract ETH is Ownable {
    // =========================================================
    //                      Safe Math
    // =========================================================

    function SafeSub(uint256 a, uint256 b) public pure returns (uint256) {
        if (a < b) {
            return (b - a);
        } else {
            return (a - b);
        }
    }

    // ========================================================
    //        Storage Variables, events and constructors
    // ========================================================

    uint256[] private open;
    uint256[] private close;
    uint256[] private high;
    uint256[] private low;
    uint256[] private volume;
    uint256[] private marketCap;
    uint256 private markets;
    uint256 private twitter_followers;
    uint256 private github_commits;
    uint256[] private algo_array;

    constructor(address initialOwner) Ownable(initialOwner) {
        open = [
            13534799814,
            7343069911,
            9208469987,
            8783159852,
            9337120056,
            23196899891,
            63193101883,
            114006004333,
            87750797272,
            141098003387,
            124380998611,
            118948001862,
            116704998016,
            132032003403,
            109577999115,
            86016197205,
            79823098183,
            107412996292,
            158472003937,
            500336990356,
            793216018677,
            2308860015869,
            2933529968262,
            2046880035400,
            3834670104980,
            3015469970703,
            3057619934082,
            4452090148926,
            7557570190430,
            11193699951172,
            8560120239258,
            3972539978027,
            6704630126953,
            5786719970703,
            4552420043945,
            4338690000000,
            2834960000000,
            2332200000000,
            1975370000000,
            1133977617990,
            1334181449080,
            1071476837210,
            1368362397420,
            1414654834500,
            1621865600670,
            2684333562290,
            2902684915370,
            2185545895820,
            1724584079730,
            1802091170890,
            1838036907560,
            1524919222820,
            1296306557030,
            1801137709060,
            2197526777649,
            1336123245119,
            2079017311050,
            2308602525610,
            2261345854090,
            3457986018570,
            4348744377240,
            3603091538700,
            3865903379000,
            6150703247500,
            7377083777800,
            13148552825500,
            14171511427600,
            19191572839100,
            27728383028800,
            27075605963500,
            22743975175800,
            25304627915500,
            34307623430700,
            30011293058231,
            42882174696576,
            46236794442015,
            36830471559386,
            26878989516973,
            29197758779522,
            32825761675900,
            27299941987023,
            19420506177248,
            10683168180002,
            16814455627267,
            15537563911596,
            13281937206528,
            15726453605386,
            12957695043818,
            11967136705721,
            15864881051415,
            16060403815803,
            18217043535926,
            18688910607926,
            18739147321964,
            19333238877329,
            18561901659675,
            16455813232205
        ];
        close = [
            5570619702,
            4208970070,
            7256649733,
            7704880238,
            9298350215,
            21163098812,
            63088498116,
            70589799881,
            84323596954,
            99636402130,
            95762596130,
            82009801865,
            112524003983,
            95632696152,
            78757300377,
            59788699150,
            79823098183,
            105518999100,
            155588998795,
            409011001586,
            730866012573,
            2144799957275,
            1337230072021,
            2046880035400,
            1950350036621,
            2775750122070,
            2811719970703,
            4144110107422,
            7420040283203,
            5744190063477,
            3686329956055,
            3638049926758,
            5125520019531,
            4079469909668,
            4228099975586,
            2546500000000,
            1702570000000,
            1887070000000,
            1017700000000,
            828298902883,
            1033364655520,
            1029345606570,
            1254027048050,
            1407375590690,
            1596602243020,
            2292574310090,
            1939904216550,
            1670714177640,
            1571303306540,
            1574634177490,
            1338023379869,
            1197800582210,
            1264900198070,
            1797451852980,
            951843005183,
            1297309443450,
            1807183341930,
            2194726778620,
            2245444903810,
            3435874341310,
            3167743457340,
            3345455653200,
            3713127381800,
            5329984282700,
            7181095174800,
            12743577546700,
            14164161846200,
            19121784083600,
            17374687479200,
            17076005949700,
            17220507809500,
            24493535355800,
            26764074147840,
            29786544151669,
            39335064907621,
            35254940537032,
            21723011525157,
            23089147306370,
            24555937269856,
            27274063382467,
            17212647487201,
            8961090090893,
            10192203189881,
            14277283557830,
            12294267080593,
            12092781567993,
            10811382441004,
            11603772535930,
            11928854356728,
            14700239826862,
            13785254019388,
            17655188951201,
            17424037545434,
            16241383321295,
            18320254181354,
            15517132501336,
            15334267290521
        ];
        high = [
            13927400112,
            13450499773,
            11064200401,
            10453699827,
            28369901180,
            66474099159,
            152571001053,
            118503999710,
            150481996536,
            215226993561,
            148989000320,
            124577999115,
            144341001511,
            135310001373,
            112454004288,
            88613300323,
            118908996582,
            160594005584,
            551147003174,
            790212020874,
            2369649963379,
            4147560119629,
            2955090026855,
            3887479858398,
            3900440063477,
            3493450012207,
            5223070068359,
            8819439697266,
            14328800048828,
            11613499755859,
            8803020019531,
            7088750000000,
            8350570068359,
            6245130004883,
            5134329833984,
            4354570000000,
            3011440000000,
            2341450000000,
            2216520000000,
            1576687034930,
            1608248890890,
            1655496274980,
            1496132291560,
            1843778488369,
            2872016388450,
            3613986730420,
            3182231159080,
            2391158986070,
            2228716899080,
            1959425085430,
            1935472485140,
            1531554027100,
            1862604898290,
            2871236968280,
            2499784915160,
            2275296899120,
            2440452613070,
            2522220028250,
            3486113722680,
            4445777546870,
            4872118899830,
            4201416563700,
            6211734204900,
            7543032341700,
            14677849420500,
            20362864933200,
            19478377530300,
            27979723849500,
            43623505418000,
            28912549710000,
            25511610842600,
            34669922831000,
            40224693596600,
            44557353969387,
            48917046975514,
            47807324839017,
            38767850857924,
            32713161539173,
            34701863042731,
            35739602434336,
            29566868876721,
            19651665820077,
            17745764401636,
            20227915557482,
            17844977849581,
            16523822187455,
            16613346634557,
            13461744826440,
            16741792675335,
            17328010975279,
            18538880031017,
            21374451201451,
            20175594826200,
            19452743126905,
            20262049230768,
            18775115199178,
            16925311645215
        ];
        low = [
            5570619702,
            4208970070,
            7256649733,
            7704880238,
            9298350215,
            21163098812,
            63088498116,
            70589799881,
            84323596954,
            99636402130,
            95762596130,
            82009801865,
            112524003983,
            95632696152,
            78757300377,
            59788699150,
            79823098183,
            105518999100,
            155588998795,
            409011001586,
            730866012573,
            2144799957275,
            1337230072021,
            2046880035400,
            1950350036621,
            2775750122070,
            2811719970703,
            4144110107422,
            7420040283203,
            5744190063477,
            3686329956055,
            3638049926758,
            5125520019531,
            4079469909668,
            4228099975586,
            2546500000000,
            1702570000000,
            1887070000000,
            1017700000000,
            828298902883,
            1033364655520,
            1029345606570,
            1254027048050,
            1407375590690,
            1596602243020,
            2292574310090,
            1939904216550,
            1670714177640,
            1571303306540,
            1574634177490,
            1338023379869,
            1197800582210,
            1264900198070,
            1797451852980,
            951843005183,
            1297309443450,
            1807183341930,
            2194726778620,
            2245444903810,
            3435874341310,
            3167743457340,
            3345455653200,
            3713127381800,
            5329984282700,
            7181095174800,
            12743577546700,
            14164161846200,
            19121784083600,
            17374687479200,
            17076005949700,
            17220507809500,
            24493535355800,
            26764074147840,
            29786544151669,
            39335064907621,
            35254940537032,
            21723011525157,
            23089147306370,
            24555937269856,
            27274063382467,
            17212647487201,
            8961090090893,
            10192203189881,
            14277283557830,
            12294267080593,
            12092781567993,
            10811382441004,
            11603772535930,
            11928854356728,
            14700239826862,
            13785254019388,
            17655188951201,
            17424037545434,
            16241383321295,
            18320254181354,
            15517132501336,
            15334267290521
        ];
        volume = [
            6199260000000000,
            6738920000000000,
            7844390000000000,
            6639940000000000,
            58475000000000000,
            76480200000000000,
            149667000000000000,
            365733000000000000,
            424334000000000000,
            158013000000000000,
            254414000000000000,
            110737000000000000,
            59508400000000000,
            133939000000000000,
            106266000000000000,
            90668000000000000,
            116487000000000000,
            654789000000000000,
            1514160000000000000,
            2299449920000000000,
            12716000000000000000,
            10118000000000000000,
            5694140160000000000,
            7062540160000000000,
            3324390080000000000,
            3695830080000000000,
            19030400000000000000,
            25542699520000000000,
            37575600640000000000,
            19639800320000000000,
            13239200000000000000,
            28531000320000000000,
            19850400000000000000,
            14759399680000000000,
            18206800000000000000,
            14119100000000000000,
            17655600000000000000,
            14423800000000000000,
            20207483955200000000,
            23583602339699998720,
            28287960307600003072,
            45354389531700002816,
            42490501973700001792,
            62758034599999995904,
            112550235147099996160,
            103031110004199997440,
            60038283398100000768,
            58302122486000001024,
            75529151483500003328,
            96079396064199999488,
            65659508675799998464,
            89368663966399987712,
            117286163938900000768,
            181812963763499991040,
            110652463169799995392,
            280891919040000000000,
            122349048133400002560,
            60940930013900005376,
            120306004915300007936,
            127747417971299991552,
            118186106099099992064,
            112769634259500007424,
            202768678329700024320,
            139268468606399987712,
            251988535808399998976,
            276370260803199991808,
            302269026208799981568,
            297771798886800031744,
            310073831503699968000,
            258280562678699982848,
            180017102827599986688,
            272805029874500009984,
            176610650992599990272,
            174981602378499981312,
            286263541108799995904,
            141572852676499996672,
            137782346136900009984,
            192661247330099986432,
            176854956856800018432,
            135209418672600006656,
            183631155597300006912,
            163507554969999998976,
            142007353698700001280,
            205916809410099970048,
            142501000931000008704,
            193069197139199983616,
            98369253038300004352,
            30185133330399997952,
            65851910188999999488,
            63236769572600004608,
            91493797632500006912,
            65396419572899995648,
            2023261661722999783424,
            2061941323956099743744,
            1775966803980199919616,
            1686783832287900073984,
            1347818673679999959040
        ];
        marketCap = [
            543514682400000000,
            681633678000000000,
            655895553700000000,
            708580227500000000,
            1768344239100000000,
            4905565699299999744,
            8967647742000000000,
            7014730166400000000,
            11342789340299999232,
            10161305670000001024,
            9801749314800001024,
            9750031192899999744,
            11175173882599999488,
            9405782637400000512,
            7426647751600000000,
            6969936000099999744,
            9487489521900001280,
            14128252882799998976,
            45178357164600000512,
            72066699167600001024,
            212448171387999977472,
            274047318605000015872,
            191025967545000001536,
            361427068135999995904,
            286074062977000013824,
            291947519849000009728,
            429479372389999968256,
            731701709673000075264,
            1088486384000000065536,
            837285641486000062464,
            390660853416999976960,
            664237122554999996416,
            576431388066999959552,
            457033020564000014336,
            438390342365999988736,
            287749225082999996416,
            238178055020999999488,
            203146281272000020480,
            117160960755900006400,
            138868377296699998208,
            112047355022000013312,
            143651182125699989504,
            149255331369099984896,
            171701104926200004608,
            285010988308599996416,
            310202959321099993088,
            234250156298400006144,
            185499062715200012288,
            194191493430299983872,
            199372567943699988480,
            165891324258599993344,
            141397657864400011264,
            197296330776100012032,
            241629131954500009984,
            147393764378300006400,
            229896470647999987712,
            256755423285400010752,
            252499137301799993344,
            386992784486600015872,
            489091700519499988992,
            406061304979599982592,
            437768291503799992320,
            698737147784799977472,
            841568107648099942400,
            1505439566573100072960,
            1626504153744399925248,
            2211518111591700103168,
            3208228747207899611136,
            3152172774828100026368,
            2650012259208299806720,
            2965329978731199987712,
            4029027702097299636224,
            3534212648600399773696,
            5066636369472299991040,
            5490857706906800095232,
            4381280034908900163584,
            3209598888653100154880,
            3496387042037600354304,
            3944259282510399668224,
            3292456872145999888384,
            2350218207150899986432,
            1295263147253499953152,
            2047717228885299953664,
            1898435900761500024832,
            1628064300806099959808,
            1924591453363999866880,
            1585584241202300190720,
            1464535234901499969536,
            1941504675995499888640,
            1965195958957099974656,
            2194767322198400040960,
            2259751703779200204800,
            2253615127756199952384,
            2324082838704200089600,
            2230707972991700172800,
            1978316612184899846144,
            2009359817604200136704
        ];
        markets = 39170000000000;
        github_commits = 145610000000000;
        algo_array = new uint256[](0);
    }

    // ========================================================
    //         Functions to add data into the array
    // ========================================================

    function addOpen(uint256 item) public onlyOwner {
        open.push(item);
    }

    function addClose(uint256 item) public onlyOwner {
        close.push(item);
    }

    function addHigh(uint256 item) public onlyOwner {
        high.push(item);
    }

    function addLow(uint256 item) public onlyOwner {
        low.push(item);
    }

    function addVolume(uint256 item) public onlyOwner {
        volume.push(item);
    }

    function addMarketCap(uint256 item) public onlyOwner {
        marketCap.push(item);
    }

    function update_markets(uint256 item) public onlyOwner {
        markets = item;
    }

    function update_github_commits(uint256 item) public onlyOwner {
        github_commits = item;
    }

    // ========================================================
    //            Functions to get the data arrays
    // ========================================================

    function getParams()
        public
        view
        returns (
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256,
            uint256,
            uint256[] memory
        )
    {
        return (
            open,
            close,
            high,
            low,
            volume,
            marketCap,
            markets,
            github_commits,
            algo_array
        );
    }

    // ============================================================
    //           Functions used in the algorithm
    // ============================================================

    function normalize_between_zero_and_1e10(
        uint256 value
    ) public pure returns (uint256) {
        unchecked {
            while (value >= 1e10) {
                value /= 10;
            }
            while (value < 0) {
                value *= 10;
            }
        }
        return uint256(value);
    }

    function check_size(
        uint256 value1,
        uint256 value2
    ) public pure returns (uint256) {
        unchecked {
            if (value1 > value2) {
                return uint256(1);
            } else {
                return uint256(0);
            }
        }
    }

    function abs(int256 n) internal pure returns (uint256) {
        unchecked {
            return uint256(n >= 0 ? n : -n);
        }
    }

    function generate_algo_array() public {
        for (uint256 i = 0; i < (open.length - 1); i++) {
            uint256 first;
            if (high[0] > low[0]) {
                first = high[0] - low[0];
            } else {
                first = low[0] - high[0];
            }
            uint256 second;
            if (close[0] > open[0]) {
                second = close[0] - open[0];
            } else {
                second = open[0] - close[0];
            }
            uint256 result;
            if (second == 0) {
                result = 1e10;
            } else {
                result = ((first * 1e10) / (second));
            }
            uint256 algo = (2 * normalize_between_zero_and_1e10(result)) +
                (2 *
                    (1e10 - (SafeSub(marketCap[i], marketCap[i + 1]) / 1e11))) +
                (2 * (1e10 - (SafeSub(volume[i], volume[i + 1]) / 1e11))) +
                (1 * ((markets) / 1e4)) +
                (2 * ((github_commits) / 1e5)) +
                (1e10 * check_size(close[i], open[i]));

            algo_array.push(algo);
        }
    }

    function return_safeness_score() public view returns (uint256) {
        uint256 score_sum = 0;
        for (uint256 i = 0; i < algo_array.length; i++) {
            score_sum = score_sum + algo_array[i];
        }
        return ((score_sum) / algo_array.length);
    }
}
