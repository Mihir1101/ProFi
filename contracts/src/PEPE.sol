// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.18;

import "@openzeppelin/contracts/access/Ownable.sol";

contract PEPE is Ownable {
    // =========================================================
    //                      Safe Math
    // =========================================================

    function SafeSub(uint256 a, uint256 b) public pure returns (uint256) {
        if (a < b) {
            return (b - a);
        } else {
            return (a - b);
        }
    }

    // ========================================================
    //        Storage Variables, events and constructors
    // ========================================================

    uint256[] private open;
    uint256[] private close;
    uint256[] private high;
    uint256[] private low;
    uint256[] private volume;
    uint256[] private marketCap;
    uint256 private markets;
    uint256 private github_commits;
    uint256[] private algo_array;

    constructor(address initialOwner) Ownable(initialOwner) {
        open = [
            657,
            1872,
            2642,
            2962,
            1983,
            2841,
            3214,
            2965,
            2617,
            2201,
            2695,
            3275,
            4577,
            7230,
            11767,
            11515,
            10765,
            19683,
            37802,
            26510,
            28256,
            19598,
            20079,
            19255,
            13951,
            17376,
            18677,
            17871,
            17332,
            16664,
            15738,
            15852,
            15242,
            17178,
            15964,
            15312,
            15954,
            14371,
            14271,
            14544,
            15137,
            14967,
            14356,
            12947,
            12623,
            12436,
            12840,
            12933,
            12388,
            10379,
            12036,
            10769,
            10847,
            11345,
            9330,
            9136,
            9058,
            9149,
            8865,
            8976,
            9672,
            10015,
            9362,
            9463,
            10697,
            13829,
            15448,
            16445,
            15539,
            16075,
            15103,
            16163,
            14238,
            15435,
            16335,
            15548,
            15861,
            18318,
            17142,
            16555,
            15490,
            15656,
            15518,
            15463,
            15175,
            15040,
            15061,
            17115,
            16439,
            16466,
            15763,
            15760,
            15152,
            15285,
            15031,
            15249,
            14877,
            15048,
            13464,
            13088,
            13363,
            13424,
            13384,
            13492,
            12945,
            12355,
            12985,
            12172,
            11995,
            11548,
            11547,
            11562,
            11157,
            11766,
            12307,
            12329,
            12454,
            13510,
            13663,
            14055,
            12664,
            11637,
            10851,
            10890,
            11341,
            11217,
            10878,
            10668,
            11040,
            9440,
            8826,
            8678,
            8955,
            8572,
            8946,
            8684,
            8055,
            7748,
            7844,
            8031,
            7964,
            8025,
            7954,
            8080,
            7952,
            7857,
            7083,
            6655,
            6735,
            6759,
            6829,
            6836,
            6758,
            6286,
            6274,
            6434,
            6277,
            6124,
            7152,
            6789,
            6748,
            7131,
            6947,
            7357,
            7343,
            7931,
            8022,
            8136,
            7447,
            7241
        ];
        close = [
            548,
            1368,
            2409,
            1718,
            1983,
            2803,
            2604,
            2095,
            2053,
            2128,
            2534,
            3082,
            4400,
            6960,
            10226,
            8470,
            10691,
            18423,
            23298,
            24666,
            15921,
            17785,
            17620,
            12711,
            10708,
            15654,
            17583,
            16197,
            16509,
            14731,
            15141,
            14893,
            15044,
            15866,
            15155,
            15228,
            13611,
            13607,
            13917,
            14387,
            14445,
            14257,
            12487,
            11971,
            12221,
            12339,
            12670,
            12287,
            9762,
            9763,
            10549,
            10384,
            10622,
            8881,
            8989,
            8562,
            8924,
            8682,
            8384,
            8811,
            9502,
            9347,
            9151,
            9120,
            10453,
            13707,
            14674,
            15073,
            15284,
            14995,
            14995,
            14076,
            14147,
            15020,
            15315,
            15068,
            15678,
            17049,
            16202,
            15436,
            15144,
            15165,
            15372,
            14408,
            14895,
            14937,
            14692,
            15636,
            16169,
            15743,
            15231,
            14957,
            15120,
            14746,
            14898,
            14821,
            14740,
            13272,
            12960,
            12334,
            13182,
            13088,
            13300,
            12668,
            12109,
            12084,
            12153,
            11975,
            11527,
            11256,
            11346,
            10715,
            11022,
            11766,
            12165,
            12251,
            12446,
            13301,
            13319,
            12576,
            11554,
            10013,
            10580,
            10885,
            11107,
            10596,
            10281,
            10507,
            9381,
            8046,
            8589,
            8674,
            8471,
            8201,
            8633,
            7997,
            7620,
            7680,
            7757,
            7875,
            7862,
            7756,
            7872,
            7779,
            7853,
            7008,
            6494,
            6644,
            6569,
            6742,
            6608,
            6733,
            6158,
            6187,
            6265,
            6181,
            6071,
            6092,
            6659,
            6623,
            6711,
            6870,
            6937,
            7104,
            7289,
            7700,
            7757,
            7339,
            7201,
            6978
        ];
        high = [
            2261,
            3677,
            4036,
            3038,
            3401,
            3613,
            3361,
            2965,
            2760,
            2797,
            3421,
            4642,
            8230,
            14390,
            14003,
            11852,
            19932,
            43539,
            38093,
            30926,
            28256,
            20987,
            21031,
            19279,
            17659,
            20551,
            19327,
            17871,
            18103,
            16847,
            16318,
            15852,
            18811,
            17469,
            15964,
            16372,
            15954,
            14639,
            14786,
            15231,
            15343,
            15096,
            14382,
            13099,
            13231,
            13013,
            13360,
            12946,
            12388,
            12568,
            12130,
            11252,
            11915,
            11363,
            9467,
            9449,
            9750,
            9439,
            9233,
            10270,
            10407,
            10015,
            9532,
            10775,
            14358,
            16758,
            17646,
            17447,
            16672,
            16216,
            16555,
            16192,
            16153,
            16945,
            16335,
            16081,
            18570,
            18665,
            17612,
            17715,
            15942,
            15932,
            15781,
            15795,
            15317,
            15604,
            17429,
            18631,
            17050,
            16643,
            15998,
            15952,
            15692,
            15557,
            15429,
            15458,
            15329,
            15072,
            13543,
            13818,
            14360,
            13674,
            13546,
            13492,
            13187,
            12994,
            13151,
            12309,
            12222,
            11652,
            11736,
            11859,
            12188,
            12843,
            12617,
            12637,
            13561,
            14204,
            14470,
            14070,
            12741,
            12132,
            11140,
            11414,
            11453,
            11272,
            10903,
            11241,
            11078,
            9442,
            9559,
            9127,
            9024,
            9035,
            8987,
            8726,
            8181,
            7961,
            8061,
            8261,
            8148,
            8050,
            8132,
            8135,
            7967,
            7857,
            7095,
            7019,
            6891,
            6943,
            6853,
            7022,
            6764,
            6485,
            6465,
            6453,
            6374,
            7257,
            7341,
            6938,
            7161,
            7238,
            7621,
            7504,
            8188,
            8149,
            8212,
            8410,
            7464,
            7241
        ];
        low = [
            548,
            1368,
            2409,
            1718,
            1983,
            2803,
            2604,
            2095,
            2053,
            2128,
            2534,
            3082,
            4400,
            6960,
            10226,
            8470,
            10691,
            18423,
            23298,
            24666,
            15921,
            17785,
            17620,
            12711,
            10708,
            15654,
            17583,
            16197,
            16509,
            14731,
            15141,
            14893,
            15044,
            15866,
            15155,
            15228,
            13611,
            13607,
            13917,
            14387,
            14445,
            14257,
            12487,
            11971,
            12221,
            12339,
            12670,
            12287,
            9762,
            9763,
            10549,
            10384,
            10622,
            8881,
            8989,
            8562,
            8924,
            8682,
            8384,
            8811,
            9502,
            9347,
            9151,
            9120,
            10453,
            13707,
            14674,
            15073,
            15284,
            14995,
            14995,
            14076,
            14147,
            15020,
            15315,
            15068,
            15678,
            17049,
            16202,
            15436,
            15144,
            15165,
            15372,
            14408,
            14895,
            14937,
            14692,
            15636,
            16169,
            15743,
            15231,
            14957,
            15120,
            14746,
            14898,
            14821,
            14740,
            13272,
            12960,
            12334,
            13182,
            13088,
            13300,
            12668,
            12109,
            12084,
            12153,
            11975,
            11527,
            11256,
            11346,
            10715,
            11022,
            11766,
            12165,
            12251,
            12446,
            13301,
            13319,
            12576,
            11554,
            10013,
            10580,
            10885,
            11107,
            10596,
            10281,
            10507,
            9381,
            8046,
            8589,
            8674,
            8471,
            8201,
            8633,
            7997,
            7620,
            7680,
            7757,
            7875,
            7862,
            7756,
            7872,
            7779,
            7853,
            7008,
            6494,
            6644,
            6569,
            6742,
            6608,
            6733,
            6158,
            6187,
            6265,
            6181,
            6071,
            6092,
            6659,
            6623,
            6711,
            6870,
            6937,
            7104,
            7289,
            7700,
            7757,
            7339,
            7201,
            6978
        ];
        volume = [
            739542005000000000,
            1700563215700000000,
            1205135164900000000,
            987774291800000128,
            728995014100000000,
            656649061500000000,
            431793111900000000,
            403081596100000000,
            430653586100000000,
            351088173200000000,
            384487353300000000,
            711951064200000000,
            2537212224200000000,
            5228252440700000256,
            3160337730899999744,
            2453714583899999744,
            5092855482400000000,
            24295155894799998976,
            16904177243000000512,
            8930877753799999488,
            12512183967900000256,
            6012259909500000256,
            4770527593000000512,
            6238720679400000512,
            9653242713099999232,
            10670244540599998464,
            4378415344200000000,
            3874035567900000256,
            2936614022799999488,
            3242951486200000000,
            2648280312000000000,
            1705408929500000000,
            3524196110600000000,
            2392176017700000256,
            1595760244100000000,
            1873735442300000000,
            2722173227500000256,
            1870854435100000000,
            1584097949600000000,
            1159930749900000000,
            1244437513500000000,
            989033273500000000,
            1396724823000000000,
            1458355293300000256,
            1340543831200000000,
            817057236500000000,
            993479742099999872,
            800551022300000000,
            1994174838300000256,
            2667132748499999744,
            1690686611100000256,
            1108369388700000000,
            1594794501300000000,
            2426981205000000000,
            1050503272600000000,
            1054318440100000000,
            1303639039600000000,
            1084767995500000000,
            1117694002600000000,
            1930149843600000256,
            1449889740600000000,
            820057365699999872,
            807744702500000000,
            1342393899500000000,
            5516116259800000512,
            8425485925100000256,
            4984993372599999488,
            3793115812300000256,
            2774374785400000000,
            2197197683400000000,
            2055399509800000000,
            1766346818000000000,
            1965690362700000000,
            3920799171899999744,
            1172011995700000000,
            1030596025000000000,
            3605593759000000000,
            1943548592900000000,
            1454736437200000000,
            2081711732600000000,
            1393209025800000256,
            733261101700000000,
            667102275300000000,
            1489420429100000000,
            750557603000000000,
            958776920400000128,
            2255270896300000000,
            3467363355800000000,
            1130334871600000000,
            745879582400000000,
            1100805073900000000,
            818029527099999872,
            748592022099999872,
            780085761200000000,
            747956000900000000,
            441814783300000000,
            482945354900000000,
            1107876860200000000,
            732139495600000000,
            1350670975500000000,
            1160691780400000000,
            845102765300000000,
            414578164000000000,
            733960314800000000,
            672639760200000000,
            992001840100000000,
            1031094960300000000,
            530711472500000000,
            674673821900000000,
            616213909800000000,
            569842517100000000,
            950854835300000000,
            1383882824199999744,
            1711251499900000000,
            719881967400000000,
            579514747100000000,
            1106801258000000000,
            1091056740200000000,
            1402487128800000000,
            1185634804400000000,
            1224986190700000000,
            1783813572700000000,
            994893040100000000,
            730750041600000000,
            453992627600000000,
            691324839599999872,
            737057655699999872,
            854070881000000000,
            1576496639199999744,
            2758374233700000256,
            1413619123600000256,
            778234947700000000,
            729840381700000000,
            1322410045700000000,
            605924802400000000,
            742461723000000000,
            703627190000000000,
            492074901500000000,
            382110099200000000,
            491417985400000000,
            401060797700000064,
            477069289099999936,
            384882268900000000,
            409830412100000000,
            216650360100000032,
            669180400400000000,
            719254914500000000,
            553944988700000000,
            448238526400000000,
            402441286800000000,
            405429853800000000,
            312381050500000000,
            459766396599999936,
            523796633500000000,
            343257736800000000,
            398183275000000000,
            328886619000000000,
            1266662599800000000,
            854853425600000000,
            453511061400000000,
            730234260500000000,
            452479842200000000,
            843692111000000000,
            613516673100000000,
            1177631167500000000,
            789836784200000000,
            649973367000000000,
            937650594000000000,
            508776240100000000,
            433185747600000000
        ];
        marketCap = [
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            14922926600700000256,
            10401462640599998464,
            11087728680199999488,
            7679655653500000256,
            7861179768999999488,
            7543903383600000000,
            5459694368800000000,
            6805837091500000256,
            7317647032100000768,
            7003218596799998976,
            6791075753200001024,
            6530064254899999744,
            6164361972899999744,
            6211861443500000256,
            5973160072700000256,
            6724898783400000512,
            6254624117500000256,
            5999301962800000000,
            6251678400599999488,
            5631613417000000512,
            5588623856900000768,
            5698134577000000512,
            5931719189900000256,
            5862617361399999488,
            5626479846400000000,
            5073157293699999744,
            4945126033799999488,
            4871430406300000256,
            5030586172200000512,
            5066950825500000256,
            4851257776000000000,
            4067058240600000000,
            4714807881299999744,
            4221715730400000000,
            4251272034700000256,
            4445431885000000000,
            3655388174900000256,
            3578949825400000000,
            3548733876299999744,
            3584874083899999744,
            3471295302400000000,
            3517805314300000256,
            3789685496800000000,
            3922330238700000256,
            3666923153899999744,
            3706601350500000256,
            4193671960800000000,
            5419741593799999488,
            6054473939800000512,
            6441559698899999744,
            6087985770700000256,
            6298984513600000000,
            5918231245100000256,
            6331136883500000256,
            5577202669800000512,
            6042555239299999744,
            6404497817400000512,
            6090530122499999744,
            6214184528499999744,
            7180558602899999744,
            6717148352899999744,
            6484963848000000000,
            6068652629299999744,
            6135474845399999488,
            6080303492899999744,
            6058278463699999744,
            5945552847799999488,
            5892861072999999488,
            5899891448200000512,
            6706103825100000256,
            6440104629299999744,
            6451630857500000256,
            6174371401000000512,
            6175465226599999488,
            5934938419900000256,
            5989771497400000512,
            5889148384800000000,
            5973655709200000000,
            5827649922599999488,
            5895762546099999744,
            5274914742599999488,
            5128243706099999744,
            5236164871800000512,
            5259751567799999488,
            5243976293900000256,
            5286650718999999488,
            5071850651200000000,
            4837069192200000512,
            5089284433200000000,
            4768870901600000000,
            4700878102700000256,
            4525713361400000000,
            4524639632699999744,
            4528999606499999744,
            4371044866299999744,
            4617060230600000512,
            4822853476099999744,
            4830374388999999488,
            4879962904700000256,
            5290555703399999488,
            5353041962499999744,
            5506517651200000000,
            4961024052700000256,
            4558798736600000512,
            4245929830099999744,
            4265013025699999744,
            4442903111899999744,
            4395294315000000000,
            4264695355200000000,
            4180139044100000256,
            4324393244900000256,
            3698731909900000256,
            3457998729200000000,
            3400271322499999744,
            3508583139900000256,
            3359901820500000256,
            3505024806299999744,
            3402690154600000000,
            3157042060500000256,
            3036302143000000000,
            3071628140699999744,
            3145196257200000512,
            3120258128100000256,
            3143576248200000000,
            3116729748500000256,
            3163854690000000000,
            3116622944499999744,
            3078473804800000000,
            2774797913899999744,
            2607679586100000256,
            2637536065099999744,
            2646772469099999744,
            2676291277500000256,
            2678729906200000000,
            2648106186500000256,
            2464126039099999744,
            2458341347000000000,
            2521108887899999744,
            2457794921299999744,
            2399241182800000000,
            2801336629400000000,
            2659593239800000000,
            2644353064000000000,
            2795052194200000000,
            2723236909200000000,
            2882747904700000256,
            2877584011499999744,
            3108088676600000512,
            3143565966000000000,
            3187907518500000256,
            2917664211000000000,
            2837364342600000000,
            2817034213600000000
        ];
        markets = 1030000000000;
        github_commits = 7350000000000;
        algo_array = new uint256[](0);
    }

    // ========================================================
    //         Functions to add data into the array
    // ========================================================

    function addOpen(uint256 item) public onlyOwner {
        open.push(item);
    }

    function addClose(uint256 item) public onlyOwner {
        close.push(item);
    }

    function addHigh(uint256 item) public onlyOwner {
        high.push(item);
    }

    function addLow(uint256 item) public onlyOwner {
        low.push(item);
    }

    function addVolume(uint256 item) public onlyOwner {
        volume.push(item);
    }

    function addMarketCap(uint256 item) public onlyOwner {
        marketCap.push(item);
    }

    function update_markets(uint256 item) public onlyOwner {
        markets = item;
    }

    function update_github_commits(uint256 item) public onlyOwner {
        github_commits = item;
    }

    // ========================================================
    //            Functions to get the data arrays
    // ========================================================

    function getParams()
        public
        view
        returns (
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256,
            uint256,
            uint256[] memory
        )
    {
        return (
            open,
            close,
            high,
            low,
            volume,
            marketCap,
            markets,
            github_commits,
            algo_array
        );
    }

    // ============================================================
    //           Functions used in the algorithm
    // ============================================================

    function normalize_between_zero_and_1e10(
        uint256 value
    ) public pure returns (uint256) {
        unchecked {
            while (value > 1e10) {
                value /= 10;
            }
            while (value < 0) {
                value *= 10;
            }
        }
        return uint256(value);
    }

    function check_size(
        uint256 value1,
        uint256 value2
    ) public pure returns (uint256) {
        unchecked {
            if (value1 > value2) {
                return uint256(1);
            } else {
                return uint256(0);
            }
        }
    }

    function abs(int256 n) internal pure returns (uint256) {
        unchecked {
            return uint256(n >= 0 ? n : -n);
        }
    }

    function generate_algo_array() public {
        for (uint256 i = 0; i < (open.length - 1); i++) {
            uint256 first;
            if (high[i] > low[i]) {
                first = high[i] - low[i];
            } else {
                first = low[i] - high[i];
            }
            uint256 second;
            if (close[i] > open[i]) {
                second = close[i] - open[i];
            } else {
                second = open[i] - close[i];
            }
            uint256 result;
            if (second == 0) {
                result = 1e10;
            } else {
                result = ((first * 1e10) / (second));
            }
            uint256 algo = (2 * normalize_between_zero_and_1e10(result)) +
                (2 *
                    (
                        SafeSub(
                            1e10,
                            (SafeSub(marketCap[i], marketCap[i + 1]) / 1e11)
                        )
                    )) +
                (2 *
                    (
                        SafeSub(
                            1e10,
                            (SafeSub(volume[i], volume[i + 1]) / 1e11)
                        )
                    )) +
                (1 * ((markets) / 1e4)) +
                (2 * ((github_commits) / 1e5)) +
                (1e10 * check_size(close[i], open[i]));

            algo_array.push(algo);
        }
    }

    function return_safeness_score() public view returns (uint256) {
        uint256 score_sum = 0;
        for (uint256 i = 0; i < algo_array.length; i++) {
            score_sum = score_sum + algo_array[i];
        }
        return ((score_sum) / algo_array.length);
    }
}
