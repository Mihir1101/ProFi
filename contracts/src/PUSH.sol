// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.18;

import "@openzeppelin/contracts/access/Ownable.sol";

contract PUSH is Ownable {
    // =========================================================
    //                      Safe Math
    // =========================================================

    function SafeSub(uint256 a, uint256 b) public pure returns (uint256) {
        if (a < b) {
            return (b - a);
        } else {
            return (a - b);
        }
    }

    // ========================================================
    //        Storage Variables, events and constructors
    // ========================================================

    uint256[] private open;
    uint256[] private close;
    uint256[] private high;
    uint256[] private low;
    uint256[] private volume;
    uint256[] private marketCap;
    uint256 private markets;
    uint256 private github_commits;
    uint256[] private algo_array;

    constructor(address initialOwner) Ownable(initialOwner) {
        open = [
            57802681100,
            51498189200,
            45325106600,
            46718520500,
            34158278900,
            19341041600,
            19836852900,
            23590417200,
            23207104799,
            18119771900,
            15048612300,
            13634556900,
            10694263000,
            7410178600,
            8935928000,
            11068838400,
            16906170000,
            18149129100,
            36592180100,
            42419028100,
            46686077900,
            37646565700,
            35241309780,
            27217544602,
            29504105314,
            28419897708,
            29411645718,
            28779122100,
            27283345760,
            27749754288,
            25455516168,
            21754882215,
            22200170092,
            19279518420,
            17418920647,
            15438790536,
            21393671312,
            24596127635,
            22216754535,
            22792958671,
            13568653581,
            12013324168,
            14048703923,
            12851234011,
            11395808125,
            10383965222,
            11398075439,
            10467184130,
            10770141585,
            12617618514,
            12614895579,
            12346521119,
            13053761724,
            10598170858,
            9252261011,
            8791099829,
            5685362198,
            5293386668,
            4631963519,
            4748349526,
            4084515488,
            3335700697,
            3734673398,
            3270672035,
            3619147761,
            3827215235,
            4268438247,
            4178222187,
            3912245336,
            3931748996,
            3537888568,
            2964762670,
            3089728831,
            3249318987,
            2810310721,
            3087113969,
            3128099171,
            3154446295,
            3173208147,
            3018672089,
            3089164971,
            3896429177,
            2576621426,
            2657369784,
            2844092358,
            2834508495,
            2772005626,
            2647952109,
            2547679681,
            2255251301,
            2375360049,
            2699779037,
            2780064358,
            2839435625,
            2971706183,
            3067916919,
            5052255141,
            4425774368,
            4229257017,
            3226803715,
            3719195762,
            3506250470,
            3638224976,
            3726161599,
            4327688984,
            3675129734,
            3645387122,
            3593957806,
            3244508914,
            3062327969,
            2930019880,
            2726679935,
            2274951206,
            2499151416,
            2517933087,
            2520344164,
            2195013659,
            2583723206,
            2332632062,
            2302665796,
            2239172914,
            2300772512,
            1986837978,
            1959849361,
            1859426315,
            1876792586,
            1808281245,
            1830846223,
            1852269420
        ];
        close = [
            46660570600,
            44146717700,
            35658171300,
            32294210700,
            14798482200,
            18567306000,
            18861985000,
            18756679500,
            16688624100,
            13165765100,
            10707985600,
            9377226300,
            7034258500,
            6475165000,
            8912563300,
            9584043500,
            15218804600,
            16471337900,
            35620107400,
            41754662900,
            36385124800,
            34091764600,
            24714743979,
            25026967752,
            27259065428,
            28108216160,
            28118300118,
            25692532903,
            25890830474,
            25105924442,
            21074748145,
            19810818288,
            17709645568,
            16602763216,
            14230308183,
            14489723784,
            20488295404,
            19650195378,
            20471614873,
            13077072782,
            11910767685,
            11393995841,
            12673228618,
            11378048659,
            9838041202,
            10010609145,
            10425853018,
            10206017547,
            10718880658,
            11614726345,
            11341067347,
            11327101213,
            10554017684,
            9119240702,
            8058574357,
            5088821472,
            5077996527,
            4374449469,
            4477085918,
            3938862588,
            2875917770,
            3133256309,
            3072333804,
            3258487424,
            3155103601,
            3823793971,
            3589655560,
            3791913117,
            3767925131,
            3531860677,
            2889776635,
            2873407605,
            2982150793,
            2738701427,
            2444997387,
            2918117712,
            3071305274,
            2988226737,
            2981469195,
            2920660109,
            2928254282,
            2544188508,
            2520036986,
            2583044871,
            2663195990,
            2666651168,
            2559623037,
            2513341994,
            2218053817,
            2214917048,
            2371829721,
            2555692826,
            2669875530,
            2694354368,
            2938967413,
            3002647107,
            4041678557,
            4106162248,
            2919746815,
            3213084133,
            3435052730,
            3329624910,
            3579914388,
            3644068768,
            3547769976,
            3548359379,
            3389079893,
            3114895547,
            2992651977,
            2826577730,
            2604788805,
            2254299550,
            2199243056,
            2457228270,
            2382225532,
            2048071505,
            2167971139,
            2298287258,
            2226003669,
            2211443292,
            2213383321,
            1813130565,
            1889618326,
            1829455246,
            1839375961,
            1759904583,
            1693819379,
            1737792012,
            1741551007
        ];
        high = [
            77914816100,
            62273387600,
            51902228100,
            54663711200,
            41369002600,
            26046293000,
            24474771400,
            24909506900,
            24151767300,
            18866683600,
            15824637000,
            14221099700,
            11982571500,
            9806590400,
            11697526200,
            18685451200,
            20021501100,
            38623047400,
            51840944100,
            59870871800,
            46938237100,
            40255481949,
            35244709732,
            31215037669,
            33089635686,
            34459250207,
            30256150263,
            29495129132,
            28471081314,
            28019807561,
            25786095080,
            24823857341,
            24706691495,
            19893522077,
            17426174190,
            22365517035,
            26002683055,
            24673494945,
            27454419247,
            22793393750,
            14877826741,
            14256660129,
            15046653026,
            13258150687,
            13326126150,
            12591772001,
            11504964097,
            11704197422,
            13390474976,
            13418483732,
            13055214808,
            14450066047,
            13123130003,
            10603359466,
            10578195922,
            8801500420,
            5699292859,
            5319473716,
            4988960929,
            4844446335,
            4092368081,
            3956069182,
            3753448039,
            3851106781,
            3889256960,
            4630380186,
            4311204443,
            4295888547,
            4280872764,
            4027857350,
            3548636009,
            3183693735,
            3344649003,
            3322497747,
            3689014787,
            3493440709,
            3395027154,
            3241099884,
            3369988065,
            3203849860,
            4272036757,
            3927033571,
            3191594587,
            2950407453,
            2936251887,
            2918017643,
            2881304250,
            2684256433,
            2657543034,
            2390180848,
            2778227287,
            2859141026,
            2856245804,
            3247603146,
            3204422455,
            5865594709,
            5190214482,
            5174944420,
            4954264282,
            3894648864,
            3888669871,
            3882852106,
            3916845084,
            4484031609,
            4334904421,
            3807392376,
            4023991243,
            3626345667,
            3301553385,
            3073245373,
            3048328474,
            2747808728,
            2516331699,
            2682945578,
            2565396305,
            2556115587,
            2599391215,
            2587965789,
            2414914847,
            2349002803,
            2318243673,
            2300772512,
            2003204952,
            2031141473,
            1954261077,
            1910695511,
            2081391518,
            1891468616,
            1867162034
        ];
        low = [
            46660570600,
            44146717700,
            35658171300,
            32294210700,
            14798482200,
            18567306000,
            18861985000,
            18756679500,
            16688624100,
            13165765100,
            10707985600,
            9377226300,
            7034258500,
            6475165000,
            8912563300,
            9584043500,
            15218804600,
            16471337900,
            35620107400,
            41754662900,
            36385124800,
            34091764600,
            24714743979,
            25026967752,
            27259065428,
            28108216160,
            28118300118,
            25692532903,
            25890830474,
            25105924442,
            21074748145,
            19810818288,
            17709645568,
            16602763216,
            14230308183,
            14489723784,
            20488295404,
            19650195378,
            20471614873,
            13077072782,
            11910767685,
            11393995841,
            12673228618,
            11378048659,
            9838041202,
            10010609145,
            10425853018,
            10206017547,
            10718880658,
            11614726345,
            11341067347,
            11327101213,
            10554017684,
            9119240702,
            8058574357,
            5088821472,
            5077996527,
            4374449469,
            4477085918,
            3938862588,
            2875917770,
            3133256309,
            3072333804,
            3258487424,
            3155103601,
            3823793971,
            3589655560,
            3791913117,
            3767925131,
            3531860677,
            2889776635,
            2873407605,
            2982150793,
            2738701427,
            2444997387,
            2918117712,
            3071305274,
            2988226737,
            2981469195,
            2920660109,
            2928254282,
            2544188508,
            2520036986,
            2583044871,
            2663195990,
            2666651168,
            2559623037,
            2513341994,
            2218053817,
            2214917048,
            2371829721,
            2555692826,
            2669875530,
            2694354368,
            2938967413,
            3002647107,
            4041678557,
            4106162248,
            2919746815,
            3213084133,
            3435052730,
            3329624910,
            3579914388,
            3644068768,
            3547769976,
            3548359379,
            3389079893,
            3114895547,
            2992651977,
            2826577730,
            2604788805,
            2254299550,
            2199243056,
            2457228270,
            2382225532,
            2048071505,
            2167971139,
            2298287258,
            2226003669,
            2211443292,
            2213383321,
            1813130565,
            1889618326,
            1829455246,
            1839375961,
            1759904583,
            1693819379,
            1737792012,
            1741551007
        ];
        volume = [
            18656287200000000,
            26148219700000004,
            21179681600000000,
            19378433300000000,
            14367166200000002,
            14443187400000000,
            19196510900000000,
            16683202400000000,
            15003755400000000,
            6137813000000000,
            18686686300000000,
            26279448700000000,
            5886186899999999,
            10209254700000000,
            38781024600000000,
            96043993200000000,
            31752226000000000,
            238042391000000000,
            51511631000000000,
            83561676900000000,
            13812042900000000,
            31436624100000000,
            27574040099999996,
            14149782200000000,
            16143201600000000,
            28274478800000000,
            27441210600000000,
            28541046200000000,
            27127755900000000,
            13581521000000000,
            10682243200000000,
            16848451000000000,
            5505312600000000,
            8210023800000000,
            10102375800000000,
            16234464800000000,
            15361332300000000,
            12116768200000000,
            7165810900000000,
            19804390800000000,
            12366521700000000,
            23692464200000000,
            15649599100000000,
            13471981500000000,
            15617594700000000,
            26400604400000000,
            15328122000000000,
            12043860100000000,
            15116113300000000,
            4357472800000000,
            4018876100000000,
            9178338100000000,
            8779397800000000,
            11505460400000000,
            14784709300000000,
            4645762400000000,
            2639302300000000,
            5739293300000000,
            4601780400000000,
            3426009500000000,
            3169729800000000,
            2221208299999999,
            1824619100000000,
            2413484300000000,
            2540984900000000,
            5552212500000000,
            2248835700000000,
            6052614500000000,
            5858806700000000,
            5819704000000000,
            5539280200000000,
            4436447600000000,
            5145422900000000,
            4795349500000000,
            5465230699999999,
            8836514000000000,
            4830379700000000,
            4249648800000000,
            4737322400000000,
            4491037500000000,
            17784618200000000,
            4730451800000000,
            5463068300000000,
            6218216600000000,
            5607122200000000,
            3384273600000000,
            3469410400000000,
            3774480700000000,
            2582061300000000,
            2693859099999999,
            3440703600000000,
            3861723700000000,
            3964535900000000,
            4757203300000000,
            2862844300000000,
            6489622900000000,
            4926392300000000,
            7751578100000001,
            3726060400000000,
            3450275700000000,
            3910757100000000,
            4644846300000000,
            4176525300000000,
            3938604200000000,
            3420251000000000,
            5354770400000000,
            4662804300000000,
            4479814099999999,
            4154474699999999,
            4881117600000000,
            5421443000000000,
            3486484500000000,
            2831939600000000,
            23703209600000000,
            21568099600000000,
            24730444600000000,
            23329972900000000,
            23237628600000000,
            22840323900000000,
            21514528500000000,
            18702045000000000,
            76529651900000000,
            75929504200000000,
            76666357000000000,
            77532153700000000,
            40416266800000000,
            23211248200000000,
            63416319700000000,
            74618849000000000
        ];
        marketCap = [
            151073592200000000,
            131807873900000000,
            158219354400000000,
            115501249800000000,
            77390715000000000,
            79321734200000000,
            107330278800000016,
            105598409600000016,
            82509294600000000,
            68377168700000000,
            62054199200000000,
            61335857300000008,
            58756686500000000,
            70799884900000000,
            87812356000000000,
            133882387899999984,
            143740199300000000,
            289864356900000000,
            335604235500000000,
            493708453600000000,
            398121793900000000,
            372643783000000000,
            287877658200000000,
            330684196100000000,
            318489262800000000,
            329614266800000000,
            322485071100000000,
            305767090000000000,
            369633071100000000,
            339184886800000000,
            289814333600000000,
            295725768400000000,
            256784617500000000,
            231933838200000000,
            205676651900000000,
            284985911300000000,
            327624286400000000,
            339696229700000000,
            348482569099999936,
            207418725799999968,
            183622277399999968,
            214791396500000000,
            196575585900000000,
            174234340400000000,
            158743190600000000,
            174166718100000000,
            159975360100000000,
            164629081900000000,
            192887611500000000,
            192872994000000000,
            188691757800000000,
            199545482500000000,
            162021062900000000,
            141522931700000000,
            134507168500000000,
            86959576300000016,
            80920666700000000,
            70806085500000000,
            72603657900000000,
            62496446400000000,
            50998829200000000,
            57103264800000008,
            49994929800000008,
            55331431500000000,
            58509258400000000,
            65302201600000000,
            63829658800000000,
            59820867000000000,
            60085922800000000,
            54088176400000000,
            45307338900000000,
            47264091000000000,
            49661708300000000,
            42945946800000000,
            84742527500000000,
            85906150700000000,
            86607875200000000,
            87099792000000000,
            82883515400000000,
            84806630900000000,
            106979955700000000,
            84013492700000000,
            86616406100000000,
            92706371000000000,
            92234238500000000,
            90354259800000000,
            86229497000000000,
            83004770400000000,
            73412543100000000,
            77342142200000000,
            87996114500000000,
            90685013600000000,
            92405098200000000,
            96862068500000000,
            100101501400000000,
            164589076100000000,
            144184777300000000,
            137750492300000000,
            105168629100000000,
            121173366000000000,
            114261395200000000,
            118606539500000000,
            121417898300000000,
            141043059500000000,
            119674646900000000,
            118810497700000000,
            117318908400000000,
            105777888500000000,
            99757590200000000,
            95481532700000000,
            88835110800000000,
            94266073400000000,
            103607227100000016,
            104416885300000000,
            104284342300000000,
            90928620700000000,
            107103983500000000,
            96742424400000000,
            95499876100000000,
            92834219000000000,
            95393567899999984,
            82418451800000000,
            81261453800000000,
            77025755400000000,
            77829539400000000,
            75020146400000000,
            75830683900000000,
            76800815900000000,
            73997286000000000
        ];
        markets = 180000000000;
        github_commits = 23490000000000;
        algo_array = new uint256[](0);
    }

    // ========================================================
    //         Functions to add data into the array
    // ========================================================

    function addOpen(uint256 item) public onlyOwner {
        open.push(item);
    }

    function addClose(uint256 item) public onlyOwner {
        close.push(item);
    }

    function addHigh(uint256 item) public onlyOwner {
        high.push(item);
    }

    function addLow(uint256 item) public onlyOwner {
        low.push(item);
    }

    function addVolume(uint256 item) public onlyOwner {
        volume.push(item);
    }

    function addMarketCap(uint256 item) public onlyOwner {
        marketCap.push(item);
    }

    function update_markets(uint256 item) public onlyOwner {
        markets = item;
    }

    function update_github_commits(uint256 item) public onlyOwner {
        github_commits = item;
    }

    // ========================================================
    //            Functions to get the data arrays
    // ========================================================

    function getParams()
        public
        view
        returns (
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256[] memory,
            uint256,
            uint256,
            uint256[] memory
        )
    {
        return (
            open,
            close,
            high,
            low,
            volume,
            marketCap,
            markets,
            github_commits,
            algo_array
        );
    }

    // ============================================================
    //           Functions used in the algorithm
    // ============================================================

    function normalize_between_zero_and_1e10(
        uint256 value
    ) public pure returns (uint256) {
        unchecked {
            while (value > 1e10) {
                value /= 10;
            }
            while (value < 0) {
                value *= 10;
            }
        }
        return uint256(value);
    }

    function check_size(
        uint256 value1,
        uint256 value2
    ) public pure returns (uint256) {
        unchecked {
            if (value1 > value2) {
                return uint256(1);
            } else {
                return uint256(0);
            }
        }
    }

    function abs(int256 n) internal pure returns (uint256) {
        unchecked {
            return uint256(n >= 0 ? n : -n);
        }
    }

    function generate_algo_array() public {
        for (uint256 i = 0; i < (open.length - 1); i++) {
            uint256 first;
            if (high[1] > low[1]) {
                first = high[1] - low[1];
            } else {
                first = low[1] - high[1];
            }
            uint256 second;
            if (close[1] > open[1]) {
                second = close[1] - open[1];
            } else {
                second = open[1] - close[1];
            }
            uint256 result;
            if (second == 0) {
                result = 1e10;
            } else {
                result = ((first * 1e10) / (second));
            }
            uint256 algo = (2 * normalize_between_zero_and_1e10(result)) +
                (2 *
                    (1e10 - (SafeSub(marketCap[i], marketCap[i + 1]) / 1e11))) +
                (2 * (1e10 - (SafeSub(volume[i], volume[i + 1]) / 1e11))) +
                (1 * ((markets) / 1e4)) +
                (2 * ((github_commits) / 1e5)) +
                (1e10 * check_size(close[i], open[i]));

            algo_array.push(algo);
        }
    }

    function return_safeness_score() public view returns (uint256) {
        uint256 score_sum = 0;
        for (uint256 i = 0; i < algo_array.length; i++) {
            score_sum = score_sum + algo_array[i];
        }
        return ((score_sum) / algo_array.length);
    }
}
